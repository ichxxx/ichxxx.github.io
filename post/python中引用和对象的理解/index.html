<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="zh-cn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Python中引用和对象的理解 | ichx&#39;s Blog</title>



<link rel="stylesheet" href="/css/style.css"/><link rel='stylesheet' href='https://ichxxx.github.io/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://ichxxx.github.io/post/python%E4%B8%AD%E5%BC%95%E7%94%A8%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%90%86%E8%A7%A3/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://ichxxx.github.io">
          <h1 id="nav-heading" class="title is-4">ichx&#39;s Blog</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/ichxxx'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:chen@ichxxx.cn'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/python/">#Python</a>




      
    </div>
    <h2 class="subtitle is-6">December 24, 2019</h2>
    <h1 class="title">Python中引用和对象的理解</h1>
    
    <div class="content">
      <blockquote>
<p>Python中引用和对象是分离的。</p>
</blockquote>
<p>在Python中，如果要使用一个变量，不需要提前进行声明，只需要在用的时候，给这个变量赋值即可。（这一点和C等静态类型语言不同，Python为动态类型语言）</p>
<p><strong>第一个例子</strong>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><p>这是一个简单的赋值语句，整数 1 为一个对象，a 是一个引用，利用赋值语句，引用 a 指向了对象 1 。</p>
<p><strong>第二个例子</strong>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">print</span>(id(a))
<span style="color:#75715e"># 496624400</span>
<span style="color:#66d9ef">print</span>(id(b))
<span style="color:#75715e"># 496624400</span>
</code></pre></div><p>a 和 b 两个引用指向了同一个对象（内存地址），这是为什么呢？ 这个跟Python的内存机制有关系，因为对于语言来说，频繁地进行对象的销毁和建立，特别浪费性能。所以在Python中，整数和短小的字符，Python都会缓存这些对象，以便重复使用。</p>
<p><strong>第三个例子</strong>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
b <span style="color:#f92672">=</span> a

<span style="color:#66d9ef">print</span>(id(a))
<span style="color:#75715e"># 496624400</span>
<span style="color:#66d9ef">print</span>(id(b))
<span style="color:#75715e"># 496624400</span>
</code></pre></div><p>可以看到 a 和 b 都指向了整数对象 1 。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>

<span style="color:#66d9ef">print</span>(id(a))
<span style="color:#75715e"># 496624416</span>
<span style="color:#66d9ef">print</span>(id(b))
<span style="color:#75715e"># 496624400</span>
</code></pre></div><p>可以看到 a 的引用改变了，但是 b 的引用未发生改变。a，b指向不同的对象。
因为我们对 a 进行了重新赋值，让它指向了新的对象 2 。即使是多个引用指向同一个对象，如果一个引用值发生变化，那么实际上是让这个引用指向一个新的引用，并不影响其他的引用的指向。从效果上看，就是各个引用各自独立，互不影响。</p>
<p><strong>第四个例子</strong>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]
b <span style="color:#f92672">=</span> a

<span style="color:#66d9ef">print</span>(id(a))
<span style="color:#75715e"># 62228800</span>
<span style="color:#66d9ef">print</span>(id(b))
<span style="color:#75715e"># 62228800</span>

a[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>

<span style="color:#66d9ef">print</span>(id(a))
<span style="color:#75715e"># 62228800</span>
<span style="color:#66d9ef">print</span>(id(b))
<span style="color:#75715e"># 62228800</span>

<span style="color:#66d9ef">print</span>(b)
<span style="color:#75715e"># [10, 2, 3]</span>
</code></pre></div><p>我们修改了对象 a 的值，但是结果并不如前一个例子那样。在这个例子中，a 和 b 的引用没有发生任何变化，但是列表对象 [1, 2, 3] 的值变成了 [10, 2, 3]。
在该情况下，我们不再对 a 这一引用赋值，而是对 a 所指向的列表的元素赋值，结果是 b 也同时发生变化。</p>
<p><strong>为什么呢？</strong>
因为 a，b 的指向没有发生变化，依然指向那个列表。</p>
<p>列表实际上是包含了多个引用的对象（每个引用是一个元素，比如a[0]，a[1] &hellip;, 每个引用指向一个对象，比如 1, 2 &hellip;）, 而 a[0] = 10 这一赋值操作，并不是改变 a 的指向，而是对 a[0]，也就是列表对象的一部份（一个元素）进行操作，所以所有指向该对象的引用都受到影响。
（与之形成对比的是，我们之前的赋值操作都没有对对象自身发生作用，只是改变引用指向。）</p>
<p>列表可以通过引用其元素，改变对象自身（in-place change）。这种对象类型，称为<strong>可变数据对象</strong>（mutable object），字典也是这样的数据类型。
而像之前的数字和字符串，不能改变对象本身，只能改变引用的指向，称为<strong>不可变数据对象</strong>（immutable object）。
同理，元组（tuple）尽管可以调用引用元素，但不可以赋值，因此不能改变对象自身，所以也算是不可变数据对象。</p>
<p>如果我们想知道引用是否指向同一个对象，我们可以使用Python的 <strong>is关键词</strong>，is 用于判断两个引用所指的对象是否相同。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>          <span style="color:#75715e"># id(a) == 496624400</span>
b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>          <span style="color:#75715e"># id(b) == 496624400</span>
<span style="color:#66d9ef">print</span>(a <span style="color:#f92672">is</span> b)
<span style="color:#75715e"># True</span>

a <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>      <span style="color:#75715e"># id(a) == 496624416</span>
<span style="color:#66d9ef">print</span>(a <span style="color:#f92672">is</span> b)
<span style="color:#75715e"># False</span>
</code></pre></div>
      
      <div class="related">

<h3>Similar articles:</h3>
<ul>
	
	<li><a href="/post/python%E4%BB%A3%E7%A0%81%E6%8A%80%E5%B7%A7/">Python代码技巧</a></li>
	
</ul>
</div>
      
    </div>
    
  </div>
</section>



<section class="section">
  <div class="container has-text-centered">
    <p></p>
    
  </div>
</section>



</body>
</html>

